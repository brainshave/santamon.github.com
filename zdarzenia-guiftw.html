<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <link rel="alternate" type="application/atom+xml" title="Long-standing Bug" href="atom.xml" />
    <link rel="stylesheet" href="media/main.css" />

    <title>Zdarzenia w GUI FTW!</title>
    <!-- work around IE (8?) not handling properly unknown tags -->
    <!-- suggested here: http://diveintohtml5.org/semantics.html -->
    <script>
      document.createElement("article");
      document.createElement("nav");
      document.createElement("aside");
      document.createElement("footer");
      document.createElement("time");
    </script>
  </head>
  <body>
    <div id="main_container">
      <div id="left_container">
        <header>
          <a href="index.html" id="logo"><img src="media/header.svg" /></a>
        </header>
        <article id="content">
  <time>2011-04-04</time>
  <h1>Zdarzenia w GUI FTW!</h1>
  

<p>Tradycyjnie w Swingu bądź SWT żeby obsłużyć zdarzenie musimy utworzyć
nową implementację jakiegoś interfejsu, np. <code>MouseListener</code> a potem
go zarejestrować w obiekcie, którego zdarzenia nas interesują.</p>

<div class="highlight"><pre><code class="java"><span class="n">button</span><span class="o">.</span><span class="na">addMouseListener</span><span class="o">(</span><span class="k">new</span> <span class="n">MouseListener</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseClicked</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseEntered</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseExited</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mousePressed</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseReleased</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
</div>


<p>Jeśli obchodzi nas tylko jedno zdarzenie, wygodnie jest dziedziczyć po
klasie <code>MouseAdapter</code>, która implementuje wszystkie metody jako puste,
wystarczy więc zaimplementować jedną metodę:</p>

<div class="highlight"><pre><code class="java"><span class="n">button</span><span class="o">.</span><span class="na">addMouseListener</span><span class="o">(</span><span class="k">new</span> <span class="n">MouseAdapter</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseClicked</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//... obsługa zdarzenia</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
</div>


<p>Jak widać, trzeba się sporo opisać zanim dotrze się do miejsca, gdzie
umieści się właściwy kod, nawet w wersji z adapterem. Jeśli jest
możliwe napisanie kodu krótszego i przynajmniej tak samo dobrze
wyrażającego co chcemy osiągnąć to moim zdaniem warto.</p>

<h2>Jak to wygląda w GUI FTW!?</h2>

<p>Obsługę zdarzeń wrzucamy do arkuszy stylów. Wygląda to tak jak każda
inna właściwość (tekst, kolor, itd.) poza tym, że nazwą właściwości
jest specyfikacja zdarzenia a wartością jest funkcja która je obsłuży.
Dzięki temu zyskujemy również na wszystkich zaletach arkuszy stylów,
np. można obsłużyć zdarzenia z wielu obiektów na raz.</p>

<div class="highlight"><pre><code class="clojure"><span class="p">(</span><span class="nf">stylesheet</span> <span class="p">[[</span><span class="nv">:cos</span> <span class="nv">:drugie-cos</span><span class="p">]</span> <span class="p">[</span><span class="nv">:text</span> <span class="s">&quot;Coś!&quot;</span>
                                 <span class="nv">&lt;spec-zdarzenia&gt;</span> <span class="nv">&lt;funkcja&gt;</span><span class="p">]])</span>
</code></pre>
</div>


<h3>Specyfikacja zdarzenia</h3>

<p>GUI FTW! musi znać dwie rzeczy: nazwę interfejsu <code>*Listener</code> i jedną
metodę do zaimplementowania &mdash; nazwę zdarzenia. Trzeba to podać w
takiej formie:</p>

<div class="highlight"><pre><code class="clojure"><span class="nv">&lt;nazwa</span> <span class="nv">interfejsu&gt;+&lt;nazwa</span> <span class="nv">metody&gt;</span>
</code></pre>
</div>


<p>Czyli np. <code>mouse+mouse-clicked</code> albo
<code>action+action-performed</code>. Odpada dzięki temu spora część zbędnego
kodu z pierwszego przykładu. Widać coś jeszcze: np. w
<code>mouse+mouse-clicked</code> słowo <code>mouse</code> powtarza się. Ponieważ występuje
to dość często dodałem skrót: jeśli napiszemy <code>++</code> zamiast <code>+</code> możemy
pozbyć się zbędnego słowa.</p>

<div class="highlight"><pre><code class="clojure"><span class="nv">mouse++clicked</span> <span class="nv">-&gt;</span> <span class="nv">mouse+mouse-clicked</span> <span class="nv">-&gt;</span> <span class="nv">MouseListener</span><span class="o">.</span><span class="nv">mouseClicked</span>
</code></pre>
</div>


<h4>Dlaczego nie uniwersalne <code>on-click</code> albo <code>on-mouse-over</code>?</h4>

<p>Takie rozwiązanie na pewno byłoby intuicyjne dla osób
początkujących. Nie widzę jednak sensu gdy <code>mouse++clicked</code> jest
wystarczająco wymowne. Poza tym powodowałoby zwiększenie kodu w GUI
FTW! specyficznego dla bibliotek, które obsługuje (w tym momencie
Swing i SWT).</p>

<p>Dzięki temu, że GUI FTW! wymaga podania nazwy interfejsu i metody,
możliwa jest obsługa zdarzeń wymyślonych przez programistę na poziomie
równym z tymi wbudowanymi w Swing bądź SWT.</p>

<h3>Funkcja obsługująca</h3>

<p>W tym momencie funkcja obsługująca zdarzenie ma jeden argument:
zdarzenie, które wystąpiło. Może to być zarówno funkcja anonimowa jak
i nazwa funkcji zdefiniowanej w innym miejscu.</p>

<h2>Przykład</h2>

<p>Rozwinę lekko przykład z poprzedniego wpisu (utrzymując poziom
hellołłorldowy). Dla przypomnienia struktura interfejsu:</p>

<div class="highlight"><pre><code class="clojure"><span class="p">(</span><span class="k">def </span><span class="nv">window</span>
  <span class="p">(</span><span class="nf">swing</span>
    <span class="p">[</span><span class="nv">JFrame</span> <span class="p">[</span><span class="nv">*id</span> <span class="nv">:okno-ftw</span><span class="p">]</span>
     <span class="p">[</span><span class="nv">JButton</span> <span class="p">[</span><span class="nv">*id</span> <span class="nv">:przycisk-omg</span><span class="p">]]]))</span>
</code></pre>
</div>


<p>Do arkusza styli dodamy obsługę zdarzenia:</p>

<div class="highlight"><pre><code class="clojure"><span class="p">(</span><span class="k">def </span><span class="nv">sheet</span>
 <span class="p">(</span><span class="nf">stylesheet</span>
  <span class="p">[</span><span class="nv">:okno-ftw</span><span class="p">]</span> <span class="p">[</span><span class="nv">:title</span> <span class="s">&quot;GUI FTW!&quot;</span>
               <span class="nv">:size</span> <span class="nv">^unroll</span> <span class="p">(</span><span class="mi">300</span> <span class="mi">200</span><span class="p">)</span>
               <span class="nv">:visible</span> <span class="nv">true</span><span class="p">]</span>
  <span class="p">[</span><span class="nv">:przycisk-omg</span><span class="p">]</span> <span class="p">[</span><span class="nv">:text</span> <span class="s">&quot;To jest przycisk!&quot;</span>
                   <span class="nv">:mouse++clicked</span>
                   <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">event</span><span class="p">]</span>
                    <span class="p">(</span><span class="nf">JOptionPane/showMessageDialog</span> <span class="nv">nil</span> <span class="s">&quot;GUI FTW!&quot;</span><span class="p">))]))</span>
</code></pre>
</div>


<p><img src="images/gui-ftw-pierwsza-akcja.png" alt="Prosty przykład podpięcia akcji pod przycisk" /></p>

<p>Pełny kod tego przykładu znajduje się <a href="https://github.com/santamon/GUIFTW/blob/master/src/guiftw/examples/swing/basic.clj">tutaj</a>.</p>



<div>
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'longstandingbug'; // required: replace example with your forum shortname

  // The following are highly recommended additional parameters. Remove the slashes in front to use.
  
  
  
  var disqus_identifier = 'zdarzenia-guiftw.html';
  var disqus_url = 'http://longstandingbug.com/zdarzenia-guiftw.html';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


</article>

      </div>
      <div id="right_container">
        <nav id="meta_menu">
          <a href="index.html">Home</a><br />
          <a href="atom.xml">Atom</a><br />
          <a href="info.html">Author</a><br />
          <a href="http://twitter.com/szywon">Twitter</a><br />
          <a href="http://github.com/santamon">GitHub</a>
        </nav>
        <nav id="projects_menu">
          <p>Projects:</p>
          <a href="http://github.com/santamon/GUIFTW">GUI FTW!</a><br />
          <a href="http://github.com/santamon/slideshow-bob">Slideshow Bob</a>
        </nav>
        <nav id="catogries_menu">
          <p>Categories:</p>
          <a href="clojure-category.html">Clojure</a><br />
          <a href="gui-ftw-category.html">GUI</a><br />
          <a href="javascript-category.html">JavaScript</a>
        </nav>
        <nav id="links_menu">
          <p>Links:</p>
          <a href="http://radek.pycka.com">Radek Pycka</a><br />
          <a href="http://blog.charmas.pl">Michał Charmas</a><br />
          <a href="http://konradhalas.blogspot.com/">Konrad Hałas</a><br />
          <a href="http://infoq.com">InfoQ</a>
        </nav>
        <nav id="archive_menu">
          <p>Archive:</p>
          
          




<label for="September_2011">September 2011</label>
<input id="September_2011" type="checkbox" />
<ul>



<li><time datetime="2011-09-11">
    11
</time> <a href="/whys-behind-new-design.html">The Whys Behind This New Freaky Design</a></li>




</ul>
<label for="June_2011">June 2011</label>
<input id="June_2011" type="checkbox" />
<ul>



<li><time datetime="2011-06-20">
    20
</time> <a href="/sound-synthesis.html">Sound Synthesis & Playback in Clojure</a></li>




</ul>
<label for="May_2011">May 2011</label>
<input id="May_2011" type="checkbox" />
<ul>



<li><time datetime="2011-05-22">
    22
</time> <a href="/webglol.html">WebGLOL</a></li>






<li><time datetime="2011-05-16">
    16
</time> <a href="/reintroducing-guiftw.html">Reintroducing GUI FTW! and Progress Report</a></li>






<li><time datetime="2011-05-07">
    7
    
</time> <a href="/restarting-in-english-mode.html">Restarting in English Mode</a></li>




</ul>
<label for="April_2011">April 2011</label>
<input id="April_2011" type="checkbox" />
<ul>



<li><time datetime="2011-04-04">
    4
    
</time> <a href="/zdarzenia-guiftw.html">Zdarzenia w GUI FTW!</a></li>




</ul>
<label for="March_2011">March 2011</label>
<input id="March_2011" type="checkbox" />
<ul>



<li><time datetime="2011-03-20">
    20
</time> <a href="/niech-sie-stanie-gui-ftw.html">Niech się stanie GUI FTW!</a></li>




</ul>
<label for="October_2010">October 2010</label>
<input id="October_2010" type="checkbox" />
<ul>



<li><time datetime="2010-10-16">
    16
</time> <a href="/idea-iluzja.html">Idea i Iluzja łeb w web</a></li>




</ul>
<label for="September_2010">September 2010</label>
<input id="September_2010" type="checkbox" />
<ul>



<li><time datetime="2010-09-03">
    3
    
</time> <a href="/blad-mlodego-parsownika.html">Błąd młodego parsownika</a></li>




</ul>
<label for="August_2010">August 2010</label>
<input id="August_2010" type="checkbox" />
<ul>



<li><time datetime="2010-08-16">
    16
</time> <a href="/intro.html">Intro</a></li>




</ul>
<label for="January_2010">January 2010</label>
<input id="January_2010" type="checkbox" />
<ul>



<li><time datetime="2010-01-07">
    7
    
</time> <a href="/efekty-uboczne-programowania.html">Efekty uboczne programowania</a></li>




</ul>
<label for="June_2009">June 2009</label>
<input id="June_2009" type="checkbox" />
<ul>



<li><time datetime="2009-06-07">
    7
    
</time> <a href="/one-makefile-to-rule-them-all.html">One Makefile To Rule Them All</a></li>


</ul>


        </nav>
      </div>
    </div>
    <footer><div>Copywrong 2011 Szymon Witamborski</div></footer>
    <script src="media/hyphenator.js"></script>
    <!-- google analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23922729-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
