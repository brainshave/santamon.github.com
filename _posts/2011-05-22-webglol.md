---
layout: post
title: WebGLOL
categories: [WebGL, OpenGL, CoffeeScript, LOL]
---

I deviated form my Clojure stuff for a while and made something
completely different.

I'm learning OpenGL recently. I've made this silly animation
[once, in Java] and wanted to see what it takes to port it to
[CoffeeScript] and [WebGL].

## Don't Even Wonder If That Means Something

<canvas id="robot_canvas" width=600 height=300 style="border: 1px solid black;"></canvas>
<script src="media/glMatrix-0.9.5.min.js"></script>
<script src="media/RequestAnimationFrame.js"></script>
<script id="shader-fs" type="x-shader/x-fragment">
    #ifdef GL_ES
    precision highp float;
    #endif

    uniform vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
</script>
<script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    }
</script>
<script src="media/robots.coffee" type="text/coffeescript"></script>
<script src="media/coffee-script.js"></script>

If you see a rectangle only it means you have to
[get WebGL-enabled browser]. It probably won't show up in feed readers
because they usually block scripts. If you don't have time to grab a
browser, here you have a video of Java version (recording is crappy,
It's my first btw.):

<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/Epncu2iq0EU?hl=pl&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/Epncu2iq0EU?hl=pl&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>

## Thoughts

Honestly I have to say that WebGL is hard. There's a lot you have to
know before you draw anything. It's bearable thanks to such great
resources as [Learning WebGL]. I've done that animation only after 3
lessons so pace of this tutorial is good. One more great thing about
it is that examples are using very minimal set of external libraries
so it's kind of close to the metal. If you don't want to write
everything by hand there's [Three.js] library which is great, but I
didn't used it because I want to learn from A to Z.

I also gave [CoffeeScript] a try and it was worth it. I like that very
succinct syntax -- my favorite is anonymous function: it's just `->`.
Some functional programming stuff like list comprehensions and
destructuring lists are very welcome too. I don't know much JavaScript
expert so I can't tell how much writing in CoffeeScript was easier but
at least it was more enjoyable.





















































<hr />

I am learning OpenGL recently. I made this silly animation in the
process and wanted to see what it takes to port it to the WebGL. And
so it is: a very unoptimised, very silly animation. If you see only black
rectangle it means that you are not using a browser that supports
WebGL. In that case visit <http://get.webgl.org> site.

Here's a video of my original OpenGL version (I'm not that pro at
recording screen either):



Anyway, I wanted to check if it's hard to do something in WebGL. It
was hard. First, without writing shaders (even simple ones) you won't
go anywhere but there are libraries that will help you out. Most
notably there's Three.js which I didn't use (I wanted to get right to
the metal of WebGL). I used
[glMatrix](http://code.google.com/p/glmatrix/) for math and
[RequestAnimationFrame](http://paulirish.com/2011/requestanimationframe-for-smart-animating/). And,
by the way, I've took a chance with [CoffeeScript](http://coffeescript.org).

This post isn't meant to be a tutorial because there's a great one
already:
[Learning WebGL](http://learningwebgl.com/blog/?page_id=1217). It's
very technical but I can't imagine how a tutorial for WebGL could be
less technical. Lessons are short but very informative and you'll
learn at a good pace. In this post I'll just share some thoughts about
my experience.

I was very happy when I figured out how to change colors of
pixels. WebGL doesn't have `glColor` function since color for a pixel
is computed in a fragment shader and there's no default
implementation. In short a fragment shader is a piece of code written
in OpenGL Shading Language that is invoked for every pixel and returns
color for that pixel. I came up with this shader:

{% highlight glsl %}
#ifdef GL_ES
precision highp float;
#endif

uniform vec4 vColor;

void main(void) {
    gl_FragColor = vColor;
}
{% endhighlight %}

What it does it just takes `vColor` "uniform" vector and sets
`gl_FragColor` with .
